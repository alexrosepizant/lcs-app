<div class="container">
  <div class="container margin-top-20" ng-if="onGoingEvents.length === 0">
    <div class="notification">
      Pas d'évènement à venir.
    </div>
  </div>

  <div class="columns bottom-50">
    <div class="column is-3">
      <aside class="menu margin-top-20">

        <p class="menu-label">
          Prochainement
        </p>
        <ul class="menu-list">
          <li>
            <a ng-repeat="event in onGoingEvents" class="sideEvent" ng-class="{'active' : event._id === currentEvent._id}" ng-click="setCurrentEvent(event)">
              <article class="media">
                <div class="media-left">
                  <div class="eventDateSmall pull-left">
                    <div class="eventDateLong">
                      {{ event.startsAt | date:"dd MMM" }}
                    </div>
                    <div class="eventYear">
                      {{ event.startsAt | date:"yyyy" }}
                    </div>
                  </div>
                </div>
                <div class="media-content" style="overflow: hidden;">
                  <div class="content">
                    <p class="three-line-ellipsis">
                      <strong>{{event.title}}</strong>
                      <br>
                      {{event.content}}
                    </p>
                  </div>
                </div>
              </article>
            </a>
          </li>
        </ul>

        <p class="menu-label">
          Evènements passés
        </p>
        <ul class="menu-list">
          <li>
            <a ng-repeat="event in pastEvents" ng-class="{'is-active' : event._id === currentEvent._id}" ng-click="setCurrentEvent(event)">
              <p class="ellipsis">{{ event.startsAt | date:"dd MMM yyyy" }}, <strong>{{event.title}}</strong></p>
            </a>
          </li>
        </ul>
      </aside>
    </div>

    <div class="column is-9 margin-top-20">
      <div>
        <button class="button is-primary event-add pull-right" ui-sref="agenda.create">
          <span class="icon is-small">
            <i class="fa fa-plus"></i>
          </span>
          &nbsp;Ajouter
        </button>
        <a class="button is-danger event-add pull-right" ng-click="remove(currentEvent._id)" ng-disabled="currentUser._id !== currentEvent.user._id">
          <span class="icon is-small">
            <i class="fa fa-remove"></i>
          </span>
          <span>
            Supprimer
          </span>
        </a>
        <a class="button event-add pull-right" ui-sref="agenda.update({userEventId: currentEvent._id})" ng-disabled="currentUser._id !== currentEvent.user._id">
          <span class="icon is-small">
            <i class="fa fa-pencil"></i>
          </span>
          <span>
            Modifier
          </span>
        </a>
      </div>

      <div class="bottom-20 margin-top-50">
        <div class="box margin-top-10">
          <h1 class="blog-subtitle-detail font-xlarge margin-top-20">
            <i class="fa fa-calendar-o"></i> <strong>{{ currentEvent.getDay() }}</strong>
            <p>{{ currentEvent.startsAt | date:"dd MMMM yyyy" }}</p>
          </h1>
          <a>
            <div class="blog-title-detail">
              {{currentEvent.title}}
            </div>
          </a>
          <div class="blogUserDetail center margin-top-10" ng-if="currentEvent.subType !== 'euroMatch'">
            <img ng-src="{{ currentEvent.user.getAvatar(80, 80) }}" title="{{ currentEvent.user.username }}">
          </div>

          <section class="margin-top-20">
            <div class="eventInfos">
              <div class="agendaTag">
                <span class="tag" ng-if="currentEvent.price"><strong>Prix</strong>{{currentEvent.price}} €</span>
                <span class="tag" ng-if="currentEvent.location.adress"><strong>Lieu</strong>{{currentEvent.location.adress}}</span>
                <span class="tag" ng-if="currentEvent.link" ng-bind-html="currentEvent.link | linky"><strong>Lien</strong>{{currentEvent.link}}</span>
              </div>
            </div>

            <div class="agenda-content">
              {{currentEvent.content}}
            </div>

            <div class="content agendaAnswer margin-top-20">
              <button class="button is-success" ng-click="isAvailableForEvent()" ng-disabled="currentEvent.user._id === currentUser._id">
                <span class="icon is-small">
                  <i class="fa fa-check"></i>
                </span>
                <span>
                  Je viens
                </span>
              </button>
              <button class="button is-danger" ng-click="isUnavailableForEvent()" ng-disabled="currentEvent.user._id === currentUser._id">
                <span class="icon is-small">
                  <i class="fa fa-remove"></i>
                </span>
                <span>
                  Je peux pas
                </span>
              </button>
            </div>
          </section>

          <div class="blog-user-section margin-top-20">
            <section class="margin-top-10" ng-if="currentEvent.guest.length > 0">
              <div ng-repeat="user in currentEvent.guest" class="authorContent pull-left">
                <span class="user-image">
                  <div class="user-image--image">
                    <div>
                      <img ng-src="{{ user.getAvatar(30,30) }}" height="30" width="30" title="{{ user.username }}">
                    </div>
                  </div>
                </span>
                <a class="authorContent-name" href="#">
                  {{user.username}}
                </a>
              </div>
            </section>
          </div>

          <section class="agendaGuestUnavailable" ng-if="currentEvent.guestUnavailable.length > 0">
            <div ng-repeat="user in currentEvent.guestUnavailable" class="authorContent pull-left">
              <span class="user-image">
                <div class="user-image--image">
                  <div>
                    <img ng-src="{{ user.getAvatar(30,30) }}" height="30" width="30" title="{{ user.username }}">
                  </div>
                </div>
              </span>
              <span class="icon-action-user fa fa-remove">
              </span>
              <a class="unavailableUser" href="#">
                {{user.username}}
              </a>
            </div>
          </section>

          <div class="clearfix">
          </div>

          <section class="blog-user-section margin-top-10 agendaComment">
            <lcs-comment type="'agenda'" object="currentEvent" class="lcs-comment"></lcs-comment>
          </section>
        </div>
      </div>
    </div>
  </div>
</div>
